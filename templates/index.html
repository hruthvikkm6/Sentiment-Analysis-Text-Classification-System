{% extends "base.html" %}

{% block title %}Home - Sentiment Analysis System{% endblock %}

{% block content %}
<div class="main-container">
    <div id="alertContainer"></div>
    
    <!-- Hero Section -->
    <div class="text-center mb-5">
        <h1 class="display-4 fw-bold text-primary mb-4">
            <i class="fas fa-brain me-3"></i>
            AI-Powered Sentiment Analysis System
        </h1>
        <p class="lead text-muted">
            Advanced natural language processing for sentiment analysis and text classification.
            Built with Python and multiple machine learning algorithms for accurate results.
        </p>
    </div>

    <!-- Features Grid -->
    <div class="row g-4 mb-5">
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center">
                <div class="card-body">
                    <div class="feature-icon">
                        <i class="fas fa-smile"></i>
                    </div>
                    <h5 class="card-title">Sentiment Analysis</h5>
                    <p class="card-text">Analyze emotions and sentiments in text using multiple algorithms including VADER, TextBlob, and custom models.</p>
                    <a href="/sentiment" class="btn btn-primary btn-custom">Try Now</a>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center">
                <div class="card-body">
                    <div class="feature-icon">
                        <i class="fas fa-tags"></i>
                    </div>
                    <h5 class="card-title">Text Classification</h5>
                    <p class="card-text">Classify text into categories like Technology, Sports, Politics, Entertainment, Business, and Health.</p>
                    <a href="/classification" class="btn btn-success btn-custom">Classify</a>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center">
                <div class="card-body">
                    <div class="feature-icon">
                        <i class="fas fa-layer-group"></i>
                    </div>
                    <h5 class="card-title">Batch Processing</h5>
                    <p class="card-text">Process multiple texts at once for efficient analysis of large datasets with comprehensive results.</p>
                    <a href="/batch" class="btn btn-warning btn-custom">Batch Process</a>
                </div>
            </div>
        </div>

        <div class="col-md-6 col-lg-3">
            <div class="card h-100 text-center">
                <div class="card-body">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h5 class="card-title">Analytics Dashboard</h5>
                    <p class="card-text">Visualize your analysis results with interactive charts, statistics, and comprehensive reports.</p>
                    <a href="/analytics" class="btn btn-info btn-custom">View Analytics</a>
                </div>
            </div>
        </div>
    </div>

    <!-- System Statistics -->
    <div class="row g-4 mb-5">
        <div class="col-12">
            <h3 class="text-center mb-4">System Performance</h3>
        </div>
        
        <div class="col-md-3">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <h3 class="fw-bold" id="totalAnalysis">0</h3>
                    <p class="mb-0">Total Analyses</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <h3 class="fw-bold">87.5%</h3>
                    <p class="mb-0">Model Accuracy</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <h3 class="fw-bold">4</h3>
                    <p class="mb-0">ML Algorithms</p>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <h3 class="fw-bold">6</h3>
                    <p class="mb-0">Text Categories</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Analysis -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-rocket me-2"></i>
                        Quick Sentiment Analysis
                    </h5>
                </div>
                <div class="card-body">
                    <form id="quickAnalysisForm">
                        <div class="mb-3">
                            <label for="quickText" class="form-label">Enter text to analyze:</label>
                            <textarea class="form-control" id="quickText" rows="3" 
                                      placeholder="Type your text here... (e.g., 'I love this new product! It's amazing!')"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary btn-custom">
                            <span class="loading-spinner spinner-border spinner-border-sm me-2" role="status"></span>
                            <i class="fas fa-search me-2"></i>
                            Analyze Now
                        </button>
                    </form>

                    <div id="quickResult" class="mt-4" style="display: none;">
                        <div class="card result-card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6>Sentiment Result:</h6>
                                        <p id="quickSentiment" class="h5"></p>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>Confidence:</h6>
                                        <div class="progress mb-2">
                                            <div id="quickConfidence" class="progress-bar" role="progressbar"></div>
                                        </div>
                                        <small id="quickConfidenceText" class="text-muted"></small>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <h6>Detailed Breakdown:</h6>
                                    <div id="quickDetails"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Technology Stack -->
    <div class="row mt-5">
        <div class="col-12">
            <h3 class="text-center mb-4">Technology Stack</h3>
            <div class="row text-center">
                <div class="col-md-2 col-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <i class="fab fa-python fa-2x text-primary mb-2"></i>
                            <p class="mb-0">Python</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-2 col-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <i class="fas fa-flask fa-2x text-success mb-2"></i>
                            <p class="mb-0">Flask</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-2 col-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <i class="fas fa-brain fa-2x text-warning mb-2"></i>
                            <p class="mb-0">NLTK</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-2 col-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <i class="fas fa-chart-bar fa-2x text-info mb-2"></i>
                            <p class="mb-0">Plotly</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-2 col-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <i class="fab fa-bootstrap fa-2x text-primary mb-2"></i>
                            <p class="mb-0">Bootstrap</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-2 col-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <i class="fas fa-database fa-2x text-secondary mb-2"></i>
                            <p class="mb-0">SQLite</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
$(document).ready(function() {
    // Load system statistics
    loadSystemStats();
    
    // Quick analysis form handler
    $('#quickAnalysisForm').submit(function(e) {
        e.preventDefault();
        performQuickAnalysis();
    });
});

function loadSystemStats() {
    $.get('/api/health')
        .done(function(data) {
            $('#totalAnalysis').text(data.analysis_history_count || 0);
        })
        .fail(function() {
            console.log('Failed to load system stats');
        });
}

function performQuickAnalysis() {
    const text = $('#quickText').val().trim();
    
    if (!text) {
        showAlert('Please enter some text to analyze.', 'warning');
        return;
    }
    
    showLoading('quickAnalysisForm');
    
    $.ajax({
        url: '/api/analyze',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({text: text}),
        dataType: 'json'
    })
    .done(function(data) {
        displayQuickResult(data);
        $('#quickResult').show();
    })
    .fail(function(xhr) {
        const error = xhr.responseJSON ? xhr.responseJSON.error : 'Analysis failed';
        showAlert('Error: ' + error, 'danger');
    })
    .always(function() {
        hideLoading('quickAnalysisForm');
    });
}

function displayQuickResult(result) {
    const sentiment = result.final_sentiment;
    const confidence = result.confidence;
    
    // Set sentiment with appropriate styling
    $('#quickSentiment').html(`<span class="${getSentimentClass(sentiment)}">${sentiment.toUpperCase()}</span>`);
    
    // Set confidence bar
    const confidencePercent = Math.round(confidence * 100);
    $('#quickConfidence').css('width', confidencePercent + '%')
                         .attr('aria-valuenow', confidencePercent);
    $('#quickConfidenceText').text(formatConfidence(confidence));
    
    // Set detailed breakdown
    const details = result.details;
    const detailsHtml = `
        <div class="row">
            <div class="col-6 col-md-3">
                <strong>VADER:</strong> ${details.vader.sentiment}
            </div>
            <div class="col-6 col-md-3">
                <strong>TextBlob:</strong> ${details.textblob.sentiment}
            </div>
            <div class="col-6 col-md-3">
                <strong>Rule-based:</strong> ${details.rule_based.sentiment}
            </div>
            <div class="col-6 col-md-3">
                <strong>Naive Bayes:</strong> ${details.naive_bayes.sentiment}
            </div>
        </div>
    `;
    
    $('#quickDetails').html(detailsHtml);
}
</script>
{% endblock %}